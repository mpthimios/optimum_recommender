package imu.recommender;

import java.io.*;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import javax.servlet.*;
import javax.servlet.http.*;

import com.fluidtime.brivel.route.json.response.JsonResponseData;
import com.fluidtime.library.model.json.JsonTrip;
import com.fluidtime.library.model.json.request.RequestTimeRoute;
import com.fluidtime.library.model.json.response.route.JsonResponseRoute;
import com.fluidtime.brivel.route.json.RouteParser;
import com.google.gson.Gson;
import sun.font.TrueTypeFont;

import static imu.recommender.CalculateMessageUtilities.calculate;


public class Recommender extends HttpServlet{
	
	private static boolean PRINT_JSON = true;
	
	public void doPost(HttpServletRequest request, HttpServletResponse response)
            throws IOException, ServletException {
		
		JsonResponseRoute route = RouteParser.routeFromJson(getBody(request));

		// Set the response message's MIME type
	    response.setContentType("text/html; charset=UTF-8");
	    // Allocate a output writer to write the response message into the network socket
	    PrintWriter out = response.getWriter();

	 
	    if (PRINT_JSON){
	    	try {
				JsonResponseRoute response_route = filtering(route);
				String mes = null;
				for (int i = 0; i < response_route.getTrips().size(); i++) {
					JsonTrip trip = response_route.getTrips().get(i);

					if (trip.getModality().equals("car")) {
						mes = "No message";
					} else {
						try {
							mes = calculate(route, trip);
							response_route.getTrips().get(i).addAttribute("message", mes);
						} catch (Exception e) {
							e.printStackTrace();
						}
						response_route.getTrips().get(i).addAttribute("message", mes);

					}
				}
				String routeResponseStr = RouteParser.routeToJson(response_route);
		    	out.println("thimios");
		    	out.println(routeResponseStr);
		    }
		    finally {

		    }	    	
	    }
	    else{
	    	try {	    		
		    	out.println("error");		    	
		    }
		    finally {

		    }
	    }
	    
	}
	
	public void doGet(HttpServletRequest request, HttpServletResponse response)
            throws IOException, ServletException {
		String data = "{\"id\":1403542101332201,\"request\":{\"sessionId\":\"EBEF04B11F496DA655128DCED1DDABCC\",\"requestId\":1},\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"\",\"title\":\"Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"\",\"title\":\"Webgasse 32\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"trips\":[{\"id\":1,\"modality\":\"pt\",\"description\":\"normal\",\"durationMinutes\":13,\"distanceMeter\":1112,\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:01:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":1,\"distanceMeter\":24,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"Wien Neubaugasse/Westbahnstr.\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T19:49:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34906,48.20236],[16.34899,48.20236]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.348989486694336,48.20341110229492]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"24\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":2,\"distanceMeter\":429,\"type\":\"ptBusCity\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"60201088\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse U\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:49:00.0+0200\",\"end\":\"2014-06-23T19:51:00.0+0200\"},\"vehicle\":{\"type\":\"ptBusCity\",\"name\":\"13A\",\"towards\":\"Wien Hauptbahnhof S+U\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34906,48.20236],[16.34907,48.20214],[16.34908,48.20176],[16.34911,48.20097],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.20029],[16.3493,48.19988],[16.34948,48.19944],[16.34969,48.19895],[16.34993,48.19858]]},\"properties\":{}}},{\"id\":3,\"durationMinutes\":10,\"distanceMeter\":659,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:51:00.0+0200\",\"end\":\"2014-06-23T20:01:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34991,48.19857],[16.34993,48.19858],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"34\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"250\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":2,\"modality\":\"pt\",\"description\":\"normal\",\"durationMinutes\":13,\"distanceMeter\":1112,\"timePlanned\":{\"start\":\"2014-06-23T19:53:00.0+0200\",\"end\":\"2014-06-23T20:06:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":1,\"distanceMeter\":24,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"Wien Neubaugasse/Westbahnstr.\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:53:00.0+0200\",\"end\":\"2014-06-23T19:54:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34906,48.20236],[16.34899,48.20236]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.348989486694336,48.20341110229492]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"24\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":2,\"distanceMeter\":429,\"type\":\"ptBusCity\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"60201088\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse U\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:54:00.0+0200\",\"end\":\"2014-06-23T19:56:00.0+0200\"},\"vehicle\":{\"type\":\"ptBusCity\",\"name\":\"13A\",\"towards\":\"Wien Hauptbahnhof S+U\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34906,48.20236],[16.34907,48.20214],[16.34908,48.20176],[16.34911,48.20097],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.20029],[16.3493,48.19988],[16.34948,48.19944],[16.34969,48.19895],[16.34993,48.19858]]},\"properties\":{}}},{\"id\":3,\"durationMinutes\":10,\"distanceMeter\":659,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:56:00.0+0200\",\"end\":\"2014-06-23T20:06:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34991,48.19857],[16.34993,48.19858],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"34\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"250\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":3,\"modality\":\"pt\",\"description\":\"normal\",\"durationMinutes\":13,\"distanceMeter\":1112,\"timePlanned\":{\"start\":\"2014-06-23T19:58:00.0+0200\",\"end\":\"2014-06-23T20:11:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":1,\"distanceMeter\":24,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"Wien Neubaugasse/Westbahnstr.\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:58:00.0+0200\",\"end\":\"2014-06-23T19:59:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34906,48.20236],[16.34899,48.20236]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.348989486694336,48.20341110229492]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"24\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":2,\"distanceMeter\":429,\"type\":\"ptBusCity\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"60201088\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse U\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:59:00.0+0200\",\"end\":\"2014-06-23T20:01:00.0+0200\"},\"vehicle\":{\"type\":\"ptBusCity\",\"name\":\"13A\",\"towards\":\"Wien Hauptbahnhof S+U\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34906,48.20236],[16.34907,48.20214],[16.34908,48.20176],[16.34911,48.20097],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.20029],[16.3493,48.19988],[16.34948,48.19944],[16.34969,48.19895],[16.34993,48.19858]]},\"properties\":{}}},{\"id\":3,\"durationMinutes\":10,\"distanceMeter\":659,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:01:00.0+0200\",\"end\":\"2014-06-23T20:11:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34991,48.19857],[16.34993,48.19858],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"34\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"250\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":4,\"modality\":\"pt\",\"description\":\"normal\",\"durationMinutes\":13,\"distanceMeter\":1112,\"timePlanned\":{\"start\":\"2014-06-23T20:03:00.0+0200\",\"end\":\"2014-06-23T20:16:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":1,\"distanceMeter\":24,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"Wien Neubaugasse/Westbahnstr.\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:03:00.0+0200\",\"end\":\"2014-06-23T20:04:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34906,48.20236],[16.34899,48.20236]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.348989486694336,48.20341110229492]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"24\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":2,\"distanceMeter\":429,\"type\":\"ptBusCity\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34899,48.20236]},\"properties\":{\"name\":\"60201088\",\"title\":\"Wien Neubaugasse/Westbahnstr.\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse U\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:04:00.0+0200\",\"end\":\"2014-06-23T20:06:00.0+0200\"},\"vehicle\":{\"type\":\"ptBusCity\",\"name\":\"13A\",\"towards\":\"Wien Hauptbahnhof S+U\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34906,48.20236],[16.34907,48.20214],[16.34908,48.20176],[16.34911,48.20097],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.20029],[16.3493,48.19988],[16.34948,48.19944],[16.34969,48.19895],[16.34993,48.19858]]},\"properties\":{}}},{\"id\":3,\"durationMinutes\":10,\"distanceMeter\":659,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34991,48.19857]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:06:00.0+0200\",\"end\":\"2014-06-23T20:16:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34991,48.19857],[16.34993,48.19858],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"34\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"250\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":5,\"modality\":\"walk\",\"description\":\"normal\",\"durationMinutes\":17,\"distanceMeter\":1138,\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:05:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":17,\"distanceMeter\":1138,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:05:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34946,48.19944],[16.34969,48.19896],[16.35011,48.1983],[16.34861,48.19778],[16.34768,48.19749],[16.3474,48.1974],[16.34668,48.19724],[16.34596,48.1971],[16.34563,48.19702],[16.34417,48.19672],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"438\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"476\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":6,\"modality\":\"bike\",\"description\":\"normal\",\"durationMinutes\":7,\"distanceMeter\":1218,\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T19:55:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":7,\"distanceMeter\":1218,\"type\":\"bike\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T19:55:00.0+0200\"},\"vehicle\":{\"type\":\"bike\",\"name\":\"bike\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.349,48.20176],[16.34697,48.20181],[16.34695,48.20179],[16.34704,48.20034],[16.34709,48.20029],[16.34701,48.19994],[16.34704,48.19982],[16.34674,48.19978],[16.34666,48.19976],[16.34672,48.19962],[16.34677,48.19962],[16.34688,48.19961],[16.34703,48.19913],[16.34712,48.19887],[16.34713,48.19882],[16.34717,48.19875],[16.3474,48.19817],[16.34768,48.19749],[16.3474,48.1974],[16.34668,48.19724],[16.34596,48.1971],[16.34563,48.19702],[16.34417,48.19672],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"0\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"158\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34695053100586,48.20178985595703]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"161\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3470401763916,48.200340270996094]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"46\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347009658813477,48.1999397277832]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"69\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.346879959106445,48.19961166381836]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"243\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347679138183594,48.19749069213867]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"274\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":7,\"modality\":\"car\",\"description\":\"normal\",\"durationMinutes\":23,\"distanceMeter\":2010,\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:11:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":23,\"distanceMeter\":2010,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:11:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34112,48.19872],[16.34027,48.19858],[16.33991,48.19853],[16.33904,48.1984],[16.33889,48.19842],[16.33866,48.19836],[16.3384,48.19829],[16.33828,48.19828],[16.33827,48.19806],[16.33827,48.19792],[16.33828,48.1978],[16.33831,48.19768],[16.33848,48.1972],[16.33875,48.19649],[16.33904,48.19568],[16.33995,48.19583],[16.34033,48.196],[16.34095,48.19612],[16.34185,48.1963],[16.34417,48.19672],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"781\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.339040756225586,48.19839859008789]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"58\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.338279724121094,48.198280334472656]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"295\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.339040756225586,48.1956787109375]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"400\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":8,\"modality\":\"par\",\"description\":\"normal\",\"durationMinutes\":36,\"distanceMeter\":2314,\"timePlanned\":{\"start\":\"2014-06-23T20:06:00.0+0200\",\"end\":\"2014-06-23T20:21:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":21,\"distanceMeter\":1072,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34352,48.19828],[16.34424,48.1968],[16.34417,48.19672],[16.34533,48.19696],[16.34533,48.19695]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"463\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.343210220336914,48.19900894165039]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"268\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"89\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":3,\"distanceMeter\":66,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"Wien Zieglergasse\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:06:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34533,48.19695],[16.34447,48.19677],[16.34444,48.19684],[16.34444,48.19684],[16.3463,48.1971]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"66\",\"durationMinutes\":\"null\"}}]}},{\"id\":3,\"durationMinutes\":1,\"distanceMeter\":518,\"type\":\"ptMetro\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"60201530\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35253,48.19917]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:09:00.0+0200\",\"end\":\"2014-06-23T20:10:00.0+0200\"},\"vehicle\":{\"type\":\"ptMetro\",\"name\":\"U3\",\"towards\":\"Wien Simmering\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34629,48.19712],[16.34682,48.19724],[16.3475,48.19741],[16.34809,48.19758],[16.34875,48.1978],[16.3502,48.19831],[16.35094,48.19857],[16.35141,48.19879],[16.35252,48.19919]]},\"properties\":{}}},{\"id\":4,\"durationMinutes\":11,\"distanceMeter\":658,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35253,48.19917]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:10:00.0+0200\",\"end\":\"2014-06-23T20:21:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.35253,48.19917],[16.35047,48.19848],[16.35047,48.19848],[16.3505,48.19846],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"258\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"249\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":9,\"modality\":\"par\",\"description\":\"normal\",\"durationMinutes\":37,\"distanceMeter\":2236,\"timePlanned\":{\"start\":\"2014-06-23T20:09:00.0+0200\",\"end\":\"2014-06-23T20:25:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":21,\"distanceMeter\":1072,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34352,48.19828],[16.34424,48.1968],[16.34417,48.19672],[16.34533,48.19696],[16.34533,48.19695]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"463\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.343210220336914,48.19900894165039]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"268\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"89\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":8,\"distanceMeter\":401,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35246,48.19924]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:09:00.0+0200\",\"end\":\"2014-06-23T20:17:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34533,48.19695],[16.34563,48.19702],[16.34598,48.1971],[16.34669,48.19724],[16.3474,48.1974],[16.34768,48.19748],[16.34861,48.19777],[16.35012,48.19829],[16.3505,48.19846],[16.35047,48.19848],[16.35047,48.19848],[16.35246,48.19924]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.345630645751953,48.197021484375]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"401\",\"durationMinutes\":\"null\"}}]}},{\"id\":3,\"durationMinutes\":1,\"distanceMeter\":519,\"type\":\"ptMetro\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35246,48.19924]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34623,48.1972]},\"properties\":{\"name\":\"60201530\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:17:00.0+0200\",\"end\":\"2014-06-23T20:18:00.0+0200\"},\"vehicle\":{\"type\":\"ptMetro\",\"name\":\"U3\",\"towards\":\"Wien Ottakring\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.35249,48.19922],[16.35017,48.19835],[16.35012,48.19832],[16.34859,48.19777],[16.34781,48.19752],[16.34705,48.19732],[16.34626,48.19715]]},\"properties\":{}}},{\"id\":4,\"durationMinutes\":7,\"distanceMeter\":244,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34623,48.1972]},\"properties\":{\"name\":\"Wien Zieglergasse\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:18:00.0+0200\",\"end\":\"2014-06-23T20:25:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34623,48.1972],[16.34447,48.1967],[16.34447,48.1967],[16.34444,48.19676],[16.34419,48.19671],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"20\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":10,\"modality\":\"par\",\"description\":\"normal\",\"durationMinutes\":35,\"distanceMeter\":2419,\"timePlanned\":{\"start\":\"2014-06-23T20:11:00.0+0200\",\"end\":\"2014-06-23T20:25:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":21,\"distanceMeter\":1072,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34352,48.19828],[16.34424,48.1968],[16.34417,48.19672],[16.34533,48.19696],[16.34533,48.19695]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"463\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.343210220336914,48.19900894165039]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"268\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"89\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":3,\"distanceMeter\":66,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"Wien Zieglergasse\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:11:00.0+0200\",\"end\":\"2014-06-23T20:14:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34533,48.19695],[16.34447,48.19677],[16.34444,48.19684],[16.34444,48.19684],[16.3463,48.1971]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"66\",\"durationMinutes\":\"null\"}}]}},{\"id\":3,\"durationMinutes\":1,\"distanceMeter\":518,\"type\":\"ptMetro\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"60201530\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35253,48.19917]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:14:00.0+0200\",\"end\":\"2014-06-23T20:15:00.0+0200\"},\"vehicle\":{\"type\":\"ptMetro\",\"name\":\"U3\",\"towards\":\"Wien Simmering\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34629,48.19712],[16.34682,48.19724],[16.3475,48.19741],[16.34809,48.19758],[16.34875,48.1978],[16.3502,48.19831],[16.35094,48.19857],[16.35141,48.19879],[16.35252,48.19919]]},\"properties\":{}}},{\"id\":4,\"durationMinutes\":2,\"type\":\"change\",\"timePlanned\":{},\"vehicle\":{}},{\"id\":5,\"durationMinutes\":1,\"distanceMeter\":519,\"type\":\"ptMetro\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35246,48.19924]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34623,48.1972]},\"properties\":{\"name\":\"60201530\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:17:00.0+0200\",\"end\":\"2014-06-23T20:18:00.0+0200\"},\"vehicle\":{\"type\":\"ptMetro\",\"name\":\"U3\",\"towards\":\"Wien Ottakring\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.35249,48.19922],[16.35017,48.19835],[16.35012,48.19832],[16.34859,48.19777],[16.34781,48.19752],[16.34705,48.19732],[16.34626,48.19715]]},\"properties\":{}}},{\"id\":6,\"durationMinutes\":7,\"distanceMeter\":244,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34623,48.1972]},\"properties\":{\"name\":\"Wien Zieglergasse\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:18:00.0+0200\",\"end\":\"2014-06-23T20:25:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34623,48.1972],[16.34447,48.1967],[16.34447,48.1967],[16.34444,48.19676],[16.34419,48.19671],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"20\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":11,\"modality\":\"par\",\"description\":\"normal\",\"durationMinutes\":36,\"distanceMeter\":2314,\"timePlanned\":{\"start\":\"2014-06-23T20:11:00.0+0200\",\"end\":\"2014-06-23T20:26:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":21,\"distanceMeter\":1072,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34352,48.19828],[16.34424,48.1968],[16.34417,48.19672],[16.34533,48.19696],[16.34533,48.19695]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"463\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.343210220336914,48.19900894165039]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"268\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"89\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":3,\"distanceMeter\":66,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"Wien Zieglergasse\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:11:00.0+0200\",\"end\":\"2014-06-23T20:14:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34533,48.19695],[16.34447,48.19677],[16.34444,48.19684],[16.34444,48.19684],[16.3463,48.1971]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"66\",\"durationMinutes\":\"null\"}}]}},{\"id\":3,\"durationMinutes\":1,\"distanceMeter\":518,\"type\":\"ptMetro\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3463,48.1971]},\"properties\":{\"name\":\"60201530\",\"title\":\"Wien Zieglergasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35253,48.19917]},\"properties\":{\"name\":\"60200056\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:14:00.0+0200\",\"end\":\"2014-06-23T20:15:00.0+0200\"},\"vehicle\":{\"type\":\"ptMetro\",\"name\":\"U3\",\"towards\":\"Wien Simmering\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34629,48.19712],[16.34682,48.19724],[16.3475,48.19741],[16.34809,48.19758],[16.34875,48.1978],[16.3502,48.19831],[16.35094,48.19857],[16.35141,48.19879],[16.35252,48.19919]]},\"properties\":{}}},{\"id\":4,\"durationMinutes\":11,\"distanceMeter\":658,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.35253,48.19917]},\"properties\":{\"name\":\"Wien Neubaugasse\",\"title\":\"Wien Neubaugasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:15:00.0+0200\",\"end\":\"2014-06-23T20:26:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.35253,48.19917],[16.35047,48.19848],[16.35047,48.19848],[16.3505,48.19846],[16.35012,48.19829],[16.34861,48.19777],[16.34768,48.19748],[16.3474,48.1974],[16.34842,48.19623],[16.34838,48.19622],[16.34785,48.19593],[16.34779,48.19593],[16.34717,48.19559],[16.34708,48.19555],[16.3467,48.19539],[16.34666,48.19539],[16.34614,48.1952],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.350109100341797,48.198299407958984]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"258\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.347400665283203,48.1973991394043]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"151\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34840965270996,48.196231842041016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"249\",\"durationMinutes\":\"null\"}}]}}]},{\"id\":12,\"modality\":\"par\",\"description\":\"normal\",\"durationMinutes\":37,\"distanceMeter\":2228,\"timePlanned\":{\"start\":\"2014-06-23T20:14:00.0+0200\",\"end\":\"2014-06-23T20:30:00.0+0200\"},\"segments\":[{\"id\":1,\"durationMinutes\":21,\"distanceMeter\":1072,\"type\":\"car\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34907,48.20214]},\"properties\":{\"name\":\"Wien, Neubaugasse 39\",\"title\":\"Wien, Neubaugasse 39\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T19:48:00.0+0200\",\"end\":\"2014-06-23T20:09:00.0+0200\"},\"vehicle\":{\"type\":\"car\",\"name\":\"car\",\"towards\":\"\",\"attributes\":{\"ew\":\"21\",\"cat\":\"32\",\"emi\":\"100\",\"fuel\":\"11\"}},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34907,48.20214],[16.34907,48.20177],[16.34907,48.20177],[16.3491,48.20098],[16.34913,48.20095],[16.34917,48.20055],[16.34921,48.2003],[16.3493,48.19989],[16.34793,48.19974],[16.34688,48.19961],[16.34685,48.1996],[16.34509,48.19932],[16.34508,48.1993],[16.34502,48.1993],[16.34321,48.19901],[16.34352,48.19828],[16.34424,48.1968],[16.34417,48.19672],[16.34533,48.19696],[16.34533,48.19695]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.2017707824707]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"41\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349069595336914,48.20214080810547]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"209\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.349300384521484,48.19989013671875]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"463\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.343210220336914,48.19900894165039]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"268\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"89\",\"durationMinutes\":\"null\"}}]}},{\"id\":2,\"durationMinutes\":5,\"distanceMeter\":295,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34533,48.19695]},\"properties\":{\"name\":\"Wien, Mariahilfer Stra?e 94\",\"title\":\"Wien, Mariahilfer Stra?e 94\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34163,48.19663]},\"properties\":{\"name\":\"Wien Kaiserstra?e\",\"title\":\"Wien Kaiserstra?e\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:14:00.0+0200\",\"end\":\"2014-06-23T20:19:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34533,48.19695],[16.34419,48.19671],[16.34185,48.19629],[16.34162,48.19644],[16.34158,48.19662],[16.34163,48.19663]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"251\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34185028076172,48.1963005065918]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"44\",\"durationMinutes\":\"null\"}}]}},{\"id\":3,\"durationMinutes\":1,\"distanceMeter\":214,\"type\":\"ptTram\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34163,48.19663]},\"properties\":{\"name\":\"60200643\",\"title\":\"Wien Kaiserstra?e\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3412,48.19855]},\"properties\":{\"name\":\"60201328\",\"title\":\"Wien Stollgasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"stop\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:19:00.0+0200\",\"end\":\"2014-06-23T20:20:00.0+0200\"},\"vehicle\":{\"type\":\"ptTram\",\"name\":\"5\",\"towards\":\"Wien Praterstern S+U\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.34158,48.19666],[16.34127,48.19795],[16.34115,48.19856]]},\"properties\":{}}},{\"id\":4,\"durationMinutes\":10,\"distanceMeter\":647,\"type\":\"walk\",\"locationFrom\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.3412,48.19855]},\"properties\":{\"name\":\"Wien Stollgasse\",\"title\":\"Wien Stollgasse\",\"municipality\":\"Wien\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"locationTo\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34561,48.19503]},\"properties\":{\"name\":\"Wien, Webgasse 32\",\"title\":\"Wien, Webgasse 32\",\"municipality\":\"\",\"municipalityId\":\"49000000\",\"type\":\"address\"}},\"timePlanned\":{\"start\":\"2014-06-23T20:20:00.0+0200\",\"end\":\"2014-06-23T20:30:00.0+0200\"},\"vehicle\":{\"type\":\"walk\",\"name\":\"walk\",\"towards\":\"\"},\"pathPolygon\":{\"type\":\"Feature\",\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.3412,48.19855],[16.34116,48.19855],[16.34128,48.19793],[16.34352,48.19828],[16.34426,48.1968],[16.34419,48.19671],[16.34407,48.19662],[16.34561,48.19503]]},\"properties\":{}},\"pathDescription\":{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.341270446777344,48.197940826416016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"68\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.341270446777344,48.197940826416016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"170\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34351921081543,48.198280334472656]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"185\",\"durationMinutes\":\"null\"}},{\"type\":\"Feature\",\"geometry\":{\"type\":\"Point\",\"coordinates\":[16.34416961669922,48.196720123291016]},\"properties\":{\"coordName\":\"WGS84\",\"distanceMeter\":\"224\",\"durationMinutes\":\"null\"}}]}}]}],\"attributes\":{\"clientid\":\"201\",\"userid\":\"201\",\"city\":\"vienna\"}}";
		//JsonResponseRoute route = RouteParser.routeFromJson(getBody(request));
		JsonResponseRoute route = RouteParser.routeFromJson(data);

		String mes = null;

		// Set the response message's MIME type
	    response.setContentType("text/html; charset=UTF-8");
	    // Allocate a output writer to write the response message into the network socket
	    PrintWriter out = response.getWriter();
		boolean PRINT_JSON = false;

	 
	    // Write the response message, in an HTML page
	    if (PRINT_JSON){
	    	String routeResponseStr = RouteParser.routeToJson(route);	    	
	    	out.println(routeResponseStr);
	    }
	    else{
	    	try {
		    	out.println("<!DOCTYPE html>");
		        out.println("<html><head>");
		        out.println("<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>");
		        out.println("<title>Echo Servlet</title></head>");
				out.println("<h3>Alternatives Routes from "+route.getLocationFrom().getProperties().getTitle()
						+" to "+route.getLocationTo().getProperties().getTitle()+":</h3>");

				try {
					//filter route
					JsonResponseRoute response_route = filtering(route);
					for (int i = 0; i < response_route.getTrips().size(); i++) {
						JsonTrip trip = response_route.getTrips().get(i);

						if (trip.getModality().equals("car") ){
							mes = "No message";
						}
						else {
							mes = calculate(route, trip);
							response_route.getTrips().get(i).addAttribute("message", mes);

						}

						if (mes != "No message"){
							out.println("<p>"+mes+"</p>");
						}
						if (trip.getModality().equals("pt")) {
							out.println("<p>Choice " + (i + 1) + ":<span style='padding-left:68px;'>" +
									"</span> Transit <span style='padding-left:68px;'></span>"
									+ trip.getDurationMinutes() + "min</p>");
						}
						if (trip.getModality().equals("car")) {
							out.println("<p>Choice " + (i + 1) + ": <span style='padding-left:68px;'>" +
									"</span> Car <span style='padding-left:68px;'></span>"
									+ trip.getDurationMinutes() + "min</p>");
						}
						if (trip.getModality().equals("walk")) {
							out.println("<p>Choice " + (i + 1) + ": <span style='padding-left:68px;'>" +
									"</span> Walk <span style='padding-left:68px;'></span>"
									+ trip.getDurationMinutes() + "min</p>");
						}
						if (trip.getModality().equals("bike")) {
							out.println("<p>Choice " + (i + 1) + ": <span style='padding-left:68px;'>" +
									"</span> Bike <span style='padding-left:68px;'></span>"
									+ trip.getDurationMinutes() + "min</p>");
						}
						if (trip.getModality().equals("par")) {
							out.println("<p>Choice " + (i + 1) + ": <span style='padding-left:68px;'>" +
									"</span>  Par  <span style='padding-left:68px;'></span> "
									+ trip.getDurationMinutes() + "min</p>");
						}
						//out.println("<p>Choice "+(i+1)+": "+mes+"</p>");

					}

				} catch (Exception e) {
					e.printStackTrace();
				}

		    }
		    finally {
		    	
		    }
	    }	    
	}
	
	public static String getBody(HttpServletRequest request) throws IOException {

	    String body = null;
	    StringBuilder stringBuilder = new StringBuilder();
	    BufferedReader bufferedReader = null;

	    try {
	        InputStream inputStream = request.getInputStream();
	        if (inputStream != null) {
	            bufferedReader = new BufferedReader(new InputStreamReader(inputStream));
	            char[] charBuffer = new char[128];
	            int bytesRead = -1;
	            while ((bytesRead = bufferedReader.read(charBuffer)) > 0) {
	                stringBuilder.append(charBuffer, 0, bytesRead);
	            }
	        } else {
	            stringBuilder.append("");
	        }
	    } catch (IOException ex) {
	        throw ex;
	    } finally {
	        if (bufferedReader != null) {
	            try {
	                bufferedReader.close();
	            } catch (IOException ex) {
	                throw ex;
	            }
	        }
	    }

	    body = stringBuilder.toString();
	    return body;
	}

	public JsonResponseRoute filtering(JsonResponseRoute route){
		JsonResponseRoute filtered_route = new JsonResponseRoute();
		filtered_route.setId(route.getId());
		filtered_route.setLocationFrom(route.getLocationFrom());
		filtered_route.setLocationTo(route.getLocationTo());
		filtered_route.addAttribute("city",route.getAttribute("city"));
		filtered_route.addAttribute("userid",route.getAttribute("userid"));
		filtered_route.addAttribute("clientid",route.getAttribute("clientid"));
		List<JsonTrip> Trips = new ArrayList<JsonTrip>();
		for (int i = 0; i < route.getTrips().size(); i++) {
			JsonTrip trip = route.getTrips().get(i);
			boolean car_owner = false;
			boolean bike_owner = true;
			//Filter out routes
			//Filter out car and park and ride modes for users that dont own a car.
			if(!car_owner){
				if ( (trip.getModality().equals("car")) || (trip.getModality().equals("par"))){
					continue;
				}
				else{
					addTrip(trip,Trips);
				}
			}
			//Filter out bike modes for users that dont own a bike and for routes containing biking more than 3 Km
			else if (trip.getModality().equals("bike")){
				if((bike_owner) && (trip.getDistanceMeter()<3000)){
					addTrip(trip,Trips);
				}
				else{
					continue;
				}
			}
			//Filter out walk modes for routes containing walking more than 1 Km
			else if(trip.getModality().equals("walk")){
				if(trip.getDistanceMeter()<1000){
					addTrip(trip,Trips);
				}
				else{
					continue;
				}
			}
			else {
				addTrip(trip,Trips);
			}

		}
		filtered_route.setTrips(Trips);
		return filtered_route;
	}
	public void addTrip(JsonTrip trip, List<JsonTrip> Trips){
		JsonTrip new_trip = new JsonTrip();
		new_trip.setSegments(trip.getSegments());
		new_trip.setDescription(trip.getDescription());
		new_trip.setDistanceMeter(trip.getDistanceMeter());
		new_trip.setDurationMinutes(trip.getDurationMinutes());
		new_trip.setModality(trip.getModality());
		new_trip.setTimePlanned(trip.getTimePlanned());
		//new_trip.setAttributes(trip.getAttributes());

		Trips.add(new_trip);
	}
}
